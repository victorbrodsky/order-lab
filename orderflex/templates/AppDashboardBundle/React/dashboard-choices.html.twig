{% extends "AppDashboardBundle/Default/base.html.twig" %}

{% import "AppOrderformBundle/Default/formmacros.html.twig" as formmacros %}

{% block title %}
    {{ title }}
{% endblock %}

{% block content %}

    {#TODO update fontawesome: spin not spinning#}
    {#<script defer src="orderassets/AppUserdirectoryBundle/fontawesome/js/all.js"></script>#}
    {#<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">#}
    {#<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">#}
    {#<link rel="stylesheet" type="text/css" href="{{ asset('orderassets/AppUserdirectoryBundle/fontawesome/css/all.min.css') }}" />#}
    {#<link rel="stylesheet" type="text/css" href="{{ asset('orderassets/AppUserdirectoryBundle/fontawesome/css/fontawesome.css') }}" />#}
    {#<link rel="stylesheet" type="text/css" href="{{ asset('orderassets/AppUserdirectoryBundle/fontawesome/css/all.css') }}" />#}
    {#<link rel="stylesheet" type="text/css" href="{{ asset('orderassets/AppUserdirectoryBundle/fontawesome/css/fontawesome.min.css') }}" />#}
    {#<script defer src="orderassets/AppUserdirectoryBundle/fontawesome/js/all.js"></script>#}
    {#<div>#}
    {#<span class="fa fa-spin fa-spinner fa-4x"></span>#}
    {#<i class="fa fa-spin fa-spinner fa-4x"></i>#}
    {#<i class="fa fa-file-pdf fa-lg"></i>#}

    {#</div>#}
    {#<p>Spinning:</p>#}
    {#<i class="fa fa-spinner fa-spin" style="font-size:24px"></i>#}

    {% if cycle is not defined %}
        {% set cycle = "show" %}
    {% endif %}

    <input type="hidden" id="formcycle" value="{{ cycle }}" />
    {#<input type="hidden" id="useWarning" value="{{ useWarning }}" />#}
    <input type="hidden" id="chartTypesCount" value="{{ chartTypesCount }}" />
    <input type="hidden" id="maxDisplayCharts" value="{{ maxDisplayCharts }}" />

    {% if testflag is defined %}
        <input type="hidden" id="testflag" value="{{ testflag }}" />
    {% endif %}


    <h4 class="text-info" align="center">
        {{ title|raw }}
    </h4>
    {#<br>#}

    <div class="form-search">
        {{ form_start(filterform) }}

        {% set simpleFilter = false %}
        {#{% set simpleFilter = true %}#}

        {% if simpleFilter %}

            <div class="row">
                <div class="col-xs-2" data-toggle="tooltip" title="Start Date">
                    {{ formmacros.fielddate(filterform.startDate,'allow-future-date') }}
                </div>
                <div class="col-xs-2" data-toggle="tooltip" title="End Date">
                    {{ formmacros.fielddate(filterform.endDate,'allow-future-date') }}
                </div>
                <div class="col-xs-2" data-toggle="tooltip" title="Specialty">
                    {% if filterform.projectSpecialty is defined %}
                        {{ form_widget(filterform.projectSpecialty, {'attr': {'placeholder': 'Specialty'}}) }}
                    {% endif %}
                </div>
                {#<div class="col-xs-2">#}
                    {#{% if filterform.compareType is defined %}#}
                        {#{{ form_widget(filterform.compareType, {'attr': {'placeholder': 'Compare Type'}}) }}#}
                    {#{% endif %}#}
                {#</div>#}
                <div class="col-xs-5" data-toggle="tooltip" title="Chart">
                    {% if filterform.chartType is defined %}
                        {{ form_widget(filterform.chartType, {'attr': {'placeholder': 'Chart'}}) }}
                    {% endif %}
                </div>
                {#<div class="col-xs-1">#}
                    {#{% if filterform.showLimited is defined %}#}
                        {#{{ formmacros.checkbox(filterform.showLimited) }}#}
                        {#{{ form_label(filterform.showLimited) }}&nbsp;{{ form_widget(filterform.showLimited) }}#}
                    {#{% endif %}#}
                {#</div>#}
                <div class="col-xs-1">
                    <button id="filter-btn" type="button" class="btn btn-default" onclick="plotlyGetChartsReact('dashboard')" data-spinner-color="{{ spinnerColor }}">Filter</button>
                </div>
            </div>

            <br>
            <div class="row">

                <div class="col-xs-1" data-toggle="tooltip" title="Hide remaining total">
                    {% if filterform.showLimited is defined %}
                        {#{{ form_label(filterform.showLimited) }}&nbsp;{{ form_widget(filterform.showLimited) }}#}
                        {#{{ form_row(filterform.showLimited) }}#}
                        {{ form_widget(filterform.showLimited) }}
                    {% endif %}
                </div>
                <div class="col-xs-1" data-toggle="tooltip" title="Quantity limit">
                    {% if filterform.quantityLimit is defined %}
                        {#{{ form_label(filterform.quantityLimit) }}&nbsp;{{ form_widget(filterform.quantityLimit) }}#}
                        {#{{ form_row(filterform.quantityLimit) }}#}
                        {{ form_widget(filterform.quantityLimit) }}
                    {% endif %}
                </div>

                <div class="col-xs-10" data-toggle="tooltip" title="Products/Services">
                    {% if filterform.category is defined %}
                        {{ form_widget(filterform.category) }}
                        {#{{ form_row(filterform.category) }}#}
                    {% endif %}
                </div>
            </div>

        {% else %}
            {#Filter form#}
            {% if 1 %}
            <div class="row">
                <div class="col-xs-11" data-toggle="tooltip" title="Chart">
                    {{ form_widget(filterform.chartType, {'attr': {'placeholder': 'Chart'}}) }}
                </div>
                <div class="col-xs-1">
                    <div class="btn-group" role="group" aria-label="Toolbar with button groups">
                        <button id="filter-btn"
                                type="button"
                                class="btn btn-default"
                                onclick="plotlyGetChartsReact('dashboard')"
                                data-spinner-color="{{ spinnerColor }}"
                        >Display</button>
                        <button id="clear-btn"
                                type="button"
                                class="btn btn-default"
                                data-toggle="tooltip" title="Clear selected charts"
                                onclick="dashboardClearAllCharts()"
                        >X</button>
                    </div>
                </div>
            </div>
            {% else %}
                {% do filterform.chartType.setRendered %}
            {% endif %}

            {% if 1 %}
            <div id="hidden-filter" class="row" style="margin-top: 10px; display: none;">
                <div class="col-xs-2" data-toggle="tooltip" title="Start Date">
                    {{ formmacros.fielddate(filterform.startDate,'allow-future-date') }}
                </div>
                <div class="col-xs-2" data-toggle="tooltip" title="End Date">
                    {{ formmacros.fielddate(filterform.endDate,'allow-future-date') }}
                </div>
                <div class="col-xs-2" data-toggle="tooltip" title="Specialty">
                    {% if filterform.projectSpecialty is defined %}
                        {{ form_widget(filterform.projectSpecialty, {'attr': {'placeholder': 'Specialty'}}) }}
                    {% endif %}
                </div>
                <div class="col-xs-1" data-toggle="tooltip" title="Hide remaining total">
                    {% if filterform.showLimited is defined %}
                        {#{{ form_label(filterform.showLimited) }}&nbsp;{{ form_widget(filterform.showLimited) }}#}
                        {#{{ form_row(filterform.showLimited) }}#}
                        {{ form_widget(filterform.showLimited) }}
                    {% endif %}
                </div>
                <div class="col-xs-1" data-toggle="tooltip" title="Quantity limit">
                    {% if filterform.quantityLimit is defined %}
                        {#{{ form_label(filterform.quantityLimit) }}&nbsp;{{ form_widget(filterform.quantityLimit) }}#}
                        {#{{ form_row(filterform.quantityLimit) }}#}
                        {{ form_widget(filterform.quantityLimit) }}
                    {% endif %}
                </div>
                <div class="col-xs-4" data-toggle="tooltip" title="Products/Services">
                    {% if filterform.category is defined %}
                        {{ form_widget(filterform.category) }}
                        {#{{ form_row(filterform.category) }}#}
                    {% endif %}
                </div>
            </div>
            {% else %}
                {% do filterform.startDate.setRendered %}
                {% do filterform.endDate.setRendered %}
                {% do filterform.projectSpecialty.setRendered %}
                {% do filterform.showLimited.setRendered %}
                {% do filterform.quantityLimit.setRendered %}
                {% do filterform.category.setRendered %}
            {% endif %}

        {% endif %}

        {{ form_end(filterform) }}
    </div>




    {#<div class="chart"></div>#}

    {#<div id="start-test" align="center">#}
        {#start-test#}
    {#</div>#}
    {#<br>#}

    <div id="root"></div>

    <div id="error-message"></div>

    <div id="charts" align="center">
        <!-- Plotly chart will be drawn inside this DIV -->
    </div>

    {#<select class="combobox 111js-example-basic-single" name="states[]" multiple="multiple">#}
        {#<option></option>#}
        {#<option value="AL">Alabama</option>#}
        {#<option value="WY">Wyoming</option>#}
        {#<option value="AL1">Alabama1</option>#}
        {#<option value="AL2">Alabama2</option>#}
    {#</select>#}

{% endblock %}


{% block stylesheets %}
    {#{{ parent() }}#}
    {{ encore_entry_link_tags('dashboard') }}
{% endblock %}
{% block javascripts %}
    {#{{ parent() }}#}
    {{ encore_entry_script_tags('dashboard') }}
{% endblock %}

{% block additionalcss %}
    {#<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">#}
    <link rel="stylesheet" type="text/css" href="{{ asset('orderassets/AppUserdirectoryBundle/fontawesome/css/all.min.css') }}" />
    <link rel="stylesheet" type="text/css" href="{{ asset('orderassets/AppUserdirectoryBundle/font-awesome-4.7/css/font-awesome.min.css') }}" />
{% endblock %}

{% block additionaljs %}
    <script src="{{ asset('orderassets/AppUserdirectoryBundle/charts/plotly/plotly.min.js') }}"></script>
    <script src="{{ asset('orderassets/AppUserdirectoryBundle/form/js/user-choices-plotly.js') }}"></script>

    {#<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />#}
    {#<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>#}

    <script language="Javascript">
        $(document).ready(function() {
            $('[data-toggle="tooltip"]').tooltip();
        });
    </script>

{% endblock %}
